<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Approval System v3.0 - Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --secondary: #8b5cf6;
            --accent: #ec4899;
            --dark: #0f172a;
            --darker: #020617;
            --light: #f1f5f9;
            --gray: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --code-bg: #1e293b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 100%);
            color: var(--light);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);
            padding: 3rem 2rem;
            border-radius: 20px;
            margin-bottom: 3rem;
            box-shadow: 0 20px 60px rgba(99, 102, 241, 0.3);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 8s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }

        .version {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.9rem;
            margin-top: 1rem;
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-top: 0.5rem;
            position: relative;
            z-index: 1;
            max-width: 800px;
        }

        /* Language Toggle */
        .lang-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 50px;
            padding: 0.5rem;
            border: 2px solid rgba(99, 102, 241, 0.3);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .lang-btn {
            color: gray;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
            padding: 0.5rem;
            transition: all 0.3s ease;
            opacity: 0.6;
        }

        .lang-btn.active {
            opacity: 1;
            transform: scale(1.2);
        }

        .lang-btn:hover {
            transform: scale(1.1);
        }

        /* Navigation */
        nav {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(99, 102, 241, 0.2);
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .nav-header {
            display: none;
        }

        .nav-toggle {
            display: none;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
            justify-content: space-between;
            align-items: center;
        }

        .nav-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.4);
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
        }

        nav a {
            color: var(--light);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: block;
            white-space: nowrap;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            transform: translateY(-2px);
        }

        /* Sections */
        section {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(99, 102, 241, 0.2);
            transition: all 0.3s ease;
        }

        section:hover {
            border-color: rgba(99, 102, 241, 0.5);
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.2);
        }

        h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: inline-block;
        }

        h3 {
            font-size: 1.5rem;
            margin: 2rem 0 1rem;
            color: var(--secondary);
        }

        h4 {
            font-size: 1.2rem;
            margin: 1.5rem 0 1rem;
            color: var(--primary);
        }

        /* Code blocks */
        pre {
            background: var(--code-bg);
            border-radius: 10px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 1rem 0;
            border-left: 4px solid var(--primary);
            position: relative;
        }

        code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            color: #e2e8f0;
        }

        /* Tables */
        .table-container {
            width: 100%;
            overflow-x: auto;
            margin: 1.5rem 0;
            border-radius: 10px;
            -webkit-overflow-scrolling: touch; /* smooth scroll on iOS */
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(15, 23, 42, 0.5);
            min-width: 600px; /* Ensure table doesn't squash on mobile */
        }

        th {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid rgba(99, 102, 241, 0.1);
        }

        tr:hover {
            background: rgba(99, 102, 241, 0.1);
        }

        /* Lists */
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 0.25rem;
            white-space: nowrap;
        }

        .badge-primary { background: linear-gradient(135deg, var(--primary), var(--secondary)); }
        .badge-success { background: var(--success); }
        .badge-warning { background: var(--warning); }

        /* Info boxes */
        .info-box, .warning-box, .success-box {
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        
        .info-box {
            background: rgba(99, 102, 241, 0.1);
            border-left: 4px solid var(--primary);
        }

        .warning-box {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
        }

        .success-box {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--success);
        }

        /* Pipeline visualization */
        .pipeline {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 2rem 0;
            padding: 2rem;
            background: rgba(15, 23, 42, 0.5);
            border-radius: 15px;
            overflow-x: auto;
        }

        .pipeline-step {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 1rem 1.5rem;
            border-radius: 10px;
            text-align: center;
            min-width: 120px;
            position: relative;
            transition: all 0.3s ease;
        }

        .pipeline-step:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
        }

        .pipeline-step::after {
            content: '‚Üí';
            position: absolute;
            right: -30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
            color: var(--primary);
        }

        .pipeline-step:last-child::after { content: ''; }

        /* Directory tree */
        .directory-tree {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 1rem 0;
            border-left: 4px solid var(--success);
            white-space: pre;
            overflow-x: auto;
        }

        .directory-tree .folder { color: var(--warning); font-weight: 600; }
        .directory-tree .file { color: #94a3b8; }

        /* Responsive */
        @media (max-width: 768px) {
            h1 { font-size: 1.8rem; }
            .subtitle { font-size: 1rem; }

            .container { padding: 1rem; }

            header {
                padding: 2rem 1rem;
                margin-top: 3rem; /* Space for lang toggle */
            }

            .lang-toggle {
                top: 10px;
                right: 10px;
                padding: 0.3rem;
            }

            .lang-btn { font-size: 1.2rem; padding: 0.3rem; }

            nav { padding: 1rem; }
            .nav-header { display: flex; }
            .nav-toggle { display: flex; }

            nav ul {
                flex-direction: column;
                gap: 0.5rem;
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.4s ease-out, margin-top 0.3s ease;
                margin-top: 0;
            }

            nav ul.open {
                max-height: 800px;
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid rgba(255,255,255,0.1);
            }

            .pipeline {
                flex-direction: column;
                gap: 2.5rem; /* Increased gap for arrow */
                padding: 1.5rem;
            }
            
            .pipeline-step {
                width: 100%;
                min-width: auto;
            }

            .pipeline-step::after {
                content: '‚Üì';
                right: 50%;
                top: auto;
                bottom: -35px; /* Adjusted position */
                transform: translateX(50%);
            }

            table { font-size: 0.85rem; }
            th, td { padding: 0.75rem 0.5rem; }

            .scroll-top {
                bottom: 1rem;
                right: 1rem;
                width: 45px;
                height: 45px;
            }
        }

        /* Scroll to top button */
        .scroll-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(99, 102, 241, 0.4);
            color: white;
            font-size: 1.2rem;
            pointer-events: none; /* Prevent clicking when invisible */
        }

        .scroll-top.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .scroll-top:hover {
            transform: translateY(-5px);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        section { animation: fadeIn 0.6s ease-out; }

        /* Links */
        a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover { color: var(--white); }
        strong { color: var(--accent); }
    </style>
</head>
<body>
    <div class="lang-toggle">
        <button class="lang-btn active" data-lang="en" title="English">üá¨üáß</button>
        <button class="lang-btn" data-lang="ru" title="–†—É—Å—Å–∫–∏–π">üá∑üá∫</button>
    </div>

    <div class="container">
        <header>
            <h1>
                <span data-en="PDF Approval System">PDF Approval System</span>
                <span data-ru="–°–∏—Å—Ç–µ–º–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è PDF" style="display:none;">–°–∏—Å—Ç–µ–º–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è PDF</span>
            </h1>
            <div class="version">
                <span data-en="Version 3.0">Version 3.0</span>
                <span data-ru="–í–µ—Ä—Å–∏—è 3.0" style="display:none;">–í–µ—Ä—Å–∏—è 3.0</span>
            </div>
            <p class="subtitle">
                <span data-en="Production automation system for flexography printing approvals at OVAL Plastic LLC">Production automation system for flexography printing approvals at OVAL Plastic LLC</span>
                <span data-ru="–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ñ–ª–µ–∫—Å–æ–ø–µ—á–∞—Ç–∏ –≤ OVAL Plastic LLC" style="display:none;">–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ñ–ª–µ–∫—Å–æ–ø–µ—á–∞—Ç–∏ –≤ OVAL Plastic LLC</span>
            </p>
        </header>

        <nav>
            <div class="nav-header">
                <button class="nav-toggle" onclick="toggleNav()">
                    <span data-en="Menu">Menu</span>
                    <span data-ru="–ú–µ–Ω—é" style="display:none;">–ú–µ–Ω—é</span>
                    <span id="nav-icon">‚ñº</span>
                </button>
            </div>
            <ul id="nav-menu">
                <li><a href="#overview"><span data-en="Overview">Overview</span><span data-ru="–û–±–∑–æ—Ä" style="display:none;">–û–±–∑–æ—Ä</span></a></li>
                <li><a href="#structure"><span data-en="Structure">Structure</span><span data-ru="–°—Ç—Ä—É–∫—Ç—É—Ä–∞" style="display:none;">–°—Ç—Ä—É–∫—Ç—É—Ä–∞</span></a></li>
                <li><a href="#core-files"><span data-en="Core Files">Core Files</span><span data-ru="–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã" style="display:none;">–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã</span></a></li>
                <li><a href="#pipeline"><span data-en="Pipeline">Pipeline</span><span data-ru="–ö–æ–Ω–≤–µ–π–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏" style="display:none;">–ö–æ–Ω–≤–µ–π–µ—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏</span></a></li>
                <li><a href="#templates"><span data-en="Templates">Templates</span><span data-ru="–®–∞–±–ª–æ–Ω—ã" style="display:none;">–®–∞–±–ª–æ–Ω—ã</span></a></li>
                <li><a href="#pantone"><span data-en="Pantone Colors">Pantone Colors</span><span data-ru="–ü–∞–ª–∏—Ç—Ä–∞ Pantone" style="display:none;">–ü–∞–ª–∏—Ç—Ä–∞ Pantone</span></a></li>
                <li><a href="#troubleshooting"><span data-en="Troubleshooting">Troubleshooting</span><span data-ru="–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞" style="display:none;">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</span></a></li>
            </ul>
        </nav>

        <section id="overview">
            <h2>
                <span data-en="System Overview">System Overview</span>
                <span data-ru="–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã" style="display:none;">–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã</span>
            </h2>
            <p>
                <span data-en="Production automation system for flexography printing approvals at OVAL Plastic LLC. The system watches">Production automation system for flexography printing approvals at OVAL Plastic LLC. The system watches</span>
                <span data-ru="–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π —Ñ–ª–µ–∫—Å–æ–ø–µ—á–∞—Ç–∏ –¥–ª—è OVAL Plastic LLC. –°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç" style="display:none;">–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π —Ñ–ª–µ–∫—Å–æ–ø–µ—á–∞—Ç–∏ –¥–ª—è OVAL Plastic LLC. –°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç</span>
                <strong>45 <span data-en="folders">folders</span><span data-ru="–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π" style="display:none;">–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π</span></strong>
                <span data-en="(3 paper types √ó 15 cup sizes), processes incoming PDFs through a 7-step pipeline, and outputs approval sheets with color information.">(3 paper types √ó 15 cup sizes), processes incoming PDFs through a 7-step pipeline, and outputs approval sheets with color information.</span>
                <span data-ru="(3 —Ç–∏–ø–∞ –±—É–º–∞–≥–∏ √ó 15 —Ä–∞–∑–º–µ—Ä–æ–≤ —Å—Ç–∞–∫–∞–Ω–æ–≤), –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ PDF —á–µ—Ä–µ–∑ 7-—ç—Ç–∞–ø–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ª–∏—Å—Ç—ã —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –æ —Ü–≤–µ—Ç–µ." style="display:none;">(3 —Ç–∏–ø–∞ –±—É–º–∞–≥–∏ √ó 15 —Ä–∞–∑–º–µ—Ä–æ–≤ —Å—Ç–∞–∫–∞–Ω–æ–≤), –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ PDF —á–µ—Ä–µ–∑ 7-—ç—Ç–∞–ø–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ª–∏—Å—Ç—ã —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –æ —Ü–≤–µ—Ç–µ.</span>
            </p>
            
            <div class="pipeline">
                <div class="pipeline-step"><span data-en="Watch Folders">Watch Folders</span><span data-ru="–ü–∞–ø–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è" style="display:none;">–ü–∞–ø–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è</span></div>
                <div class="pipeline-step"><span data-en="Trapping">Trapping</span><span data-ru="–¢—Ä–µ–ø–ø–∏–Ω–≥" style="display:none;">–¢—Ä–µ–ø–ø–∏–Ω–≥</span></div>
                <div class="pipeline-step"><span data-en="Esko Color Separation">Esko Color Separation</span><span data-ru="–¶–≤–µ—Ç–æ–¥–µ–ª–µ–Ω–∏–µ Esko" style="display:none;">–¶–≤–µ—Ç–æ–¥–µ–ª–µ–Ω–∏–µ Esko</span></div>
                <div class="pipeline-step"><span data-en="RIP Generation">RIP Generation</span><span data-ru="–ì–µ–Ω–µ—Ä–∞—Ü–∏—è RIP" style="display:none;">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è RIP</span></div>
                <div class="pipeline-step"><span data-en="Template Merge">Template Merge</span><span data-ru="–°–≤–µ–¥–µ–Ω–∏–µ —Å —à–∞–±–ª–æ–Ω–æ–º" style="display:none;">–°–≤–µ–¥–µ–Ω–∏–µ —Å —à–∞–±–ª–æ–Ω–æ–º</span></div>
                <div class="pipeline-step"><span data-en="PNG Export">PNG Export</span><span data-ru="–≠–∫—Å–ø–æ—Ä—Ç –≤ PNG" style="display:none;">–≠–∫—Å–ø–æ—Ä—Ç –≤ PNG</span></div>
                <div class="pipeline-step"><span data-en="Output">Output</span><span data-ru="–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª" style="display:none;">–ì–æ—Ç–æ–≤—ã–π —Ñ–∞–π–ª</span></div>
            </div>
        </section>

        <section id="structure">
            <h2>
                <span data-en="Directory Structure">Directory Structure</span>
                <span data-ru="–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤" style="display:none;">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤</span>
            </h2>
            <div class="directory-tree">
C:\ExampleJobContainer\
‚îú‚îÄ‚îÄ <span class="folder">Approval_System\</span>
‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">MakeApproval\</span>              <span class="file"># Watch folders (input) / –ü–∞–ø–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è</span>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">Craft\</span>                 <span class="file"># 15 cup sizes / 15 —Ä–∞–∑–º–µ—Ä–æ–≤</span>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">Glossy\</span>                <span class="file"># 15 cup sizes / 15 —Ä–∞–∑–º–µ—Ä–æ–≤</span>
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ <span class="folder">Laminated\</span>             <span class="file"># 15 cup sizes / 15 —Ä–∞–∑–º–µ—Ä–æ–≤</span>
‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">Templates\</span>                 <span class="file"># Approval templates / –®–∞–±–ª–æ–Ω—ã —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</span>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">Templates_Craft\</span>
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">Templates_Glossy\</span>
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ <span class="folder">Templates_Laminated\</span>
‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">ClientApprovals\</span>           <span class="file"># Final output (PNG files) / –ì–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã</span>
‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">Processed\</span>                 <span class="file"># Successfully processed / –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ PDF</span>
‚îÇ   ‚îú‚îÄ‚îÄ <span class="folder">RIP\</span>                       <span class="file"># Temporary RIP PDF storage / –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</span>
‚îÇ   ‚îî‚îÄ‚îÄ <span class="folder">Scripts\</span>                   <span class="file"># Automation scripts / –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏</span>
‚îÇ       ‚îú‚îÄ‚îÄ <span class="file">approval_automation_v2.py</span>
‚îÇ       ‚îú‚îÄ‚îÄ <span class="file">Path_Config.json</span>
‚îÇ       ‚îú‚îÄ‚îÄ <span class="file">trapping_automation.ahk</span>
‚îÇ       ‚îú‚îÄ‚îÄ <span class="file">bitmap_to_rip_automation.ahk</span>
‚îÇ       ‚îú‚îÄ‚îÄ <span class="file">Mardoto-Medium.ttf</span>
‚îÇ       ‚îú‚îÄ‚îÄ <span class="folder">images\</span>                <span class="file"># Ref. images for AHK / –†–µ—Ñ–µ—Ä–µ–Ω—Å—ã –¥–ª—è AHK</span>
‚îÇ       ‚îî‚îÄ‚îÄ <span class="folder">backup_v2.0_working\</span>   <span class="file"># Backup / –ë—ç–∫–∞–ø</span>
‚îî‚îÄ‚îÄ <span class="folder">Flexo_Approval\</span>                <span class="file"># Esko Automation Engine hotfolder</span>
    ‚îî‚îÄ‚îÄ <span class="folder">work\</span>
        ‚îî‚îÄ‚îÄ <span class="folder">Esko\</span>
            ‚îî‚îÄ‚îÄ <span class="folder">Output\</span>            <span class="file"># .view files from Esko</span>
            </div>
        </section>

        <section id="core-files">
            <h2>
                <span data-en="Core Files">Core Files</span>
                <span data-ru="–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã" style="display:none;">–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã</span>
            </h2>

            <h3>1. approval_automation_v2.py <span style="color: var(--light);" class="badge badge-primary">Main Orchestrator</span></h3>
            <p><strong>Location:</strong> <code>Scripts/approval_automation_v2.py</code></p>
            <p>
                <span data-en="Main Python script that orchestrates the entire workflow.">Main Python script that orchestrates the entire workflow.</span>
                <span data-ru="–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç Python, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –≤—Å–µ–º —Ä–∞–±–æ—á–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º." style="display:none;">–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç Python, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –≤—Å–µ–º —Ä–∞–±–æ—á–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.</span>
            </p>

            <h4><span data-en="Key Functions">Key Functions</span><span data-ru="–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏" style="display:none;">–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</span></h4>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>load_config()</code></td>
                            <td>Loads Path_Config.json configuration</td>
                        </tr>
                        <tr>
                            <td><code>process_pdf()</code></td>
                            <td>Main processing pipeline for single PDF</td>
                        </tr>
                        <tr>
                            <td><code>run_trapping_script()</code></td>
                            <td>Executes AHK trapping automation</td>
                        </tr>
                        <tr>
                            <td><code>wait_for_view_file()</code></td>
                            <td>Waits for Esko .view files, returns count</td>
                        </tr>
                        <tr>
                            <td><code>run_ahk_script()</code></td>
                            <td>Executes AHK RIP automation</td>
                        </tr>
                        <tr>
                            <td><code>wait_for_rip_pdf()</code></td>
                            <td>Waits for RIP PDF to appear</td>
                        </tr>
                        <tr>
                            <td><code>combine_pdfs()</code></td>
                            <td>Merges RIP with template using magenta positioning</td>
                        </tr>
                        <tr>
                            <td><code>find_magenta_rectangles()</code></td>
                            <td>Detects magenta markers in template</td>
                        </tr>
                        <tr>
                            <td><code>draw_color_table()</code></td>
                            <td>Draws color list table on approval</td>
                        </tr>
                        <tr>
                            <td><code>export_to_png()</code></td>
                            <td>Converts final PDF to PNG</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="info-box">
                <strong>Dependencies:</strong> PyMuPDF (fitz), Python 3.x standard library
            </div>

            <h4>Startup Command</h4>
            <pre><code>python approval_automation_v2.py</code></pre>

            <h3>2. Path_Config.json <span style="color: var(--light);" class="badge badge-success">Configuration</span></h3>
            <p><strong>Location:</strong> <code>Scripts/Path_Config.json</code></p>

            <h4><span data-en="Key Settings">Key Settings</span><span data-ru="–ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏" style="display:none;">–ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</span></h4>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Setting</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>crop_margin</code></td>
                            <td>int</td>
                            <td>Points margin for RIP cropping</td>
                        </tr>
                        <tr>
                            <td><code>x_offset / y_offset</code></td>
                            <td>float</td>
                            <td>Fine-tune RIP position on template</td>
                        </tr>
                        <tr>
                            <td><code>color_count_rgb</code></td>
                            <td>[R,G,B]</td>
                            <td>Color for count text (green: [0, 100, 47])</td>
                        </tr>
                        <tr>
                            <td><code>export_png_dpi</code></td>
                            <td>int</td>
                            <td>PNG export resolution (485 recommended)</td>
                        </tr>
                        <tr>
                            <td><code>color_table_align_right</code></td>
                            <td>bool</td>
                            <td>Position table on right side</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>3. trapping_automation.ahk <span style="color: var(--light);" class="badge badge-warning">Trapping Script</span></h3>
            <p><strong>Location:</strong> <code>Scripts/trapping_automation.ahk</code></p>
            <p>
                <span data-en="Automates Adobe Acrobat + Prinect PDF Toolbox to apply 0.25mm trapping.">Automates Adobe Acrobat + Prinect PDF Toolbox to apply 0.25mm trapping.</span>
                <span data-ru="–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç Adobe Acrobat + Prinect PDF Toolbox –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–ø–ø–∏–Ω–≥–∞ 0.25–º–º." style="display:none;">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç Adobe Acrobat + Prinect PDF Toolbox –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–ø–ø–∏–Ω–≥–∞ 0.25–º–º.</span>
            </p>

            <h4>Requirements</h4>
            <ul>
                <li>AutoHotkey v2.0+</li>
                <li>Adobe Acrobat XI Pro</li>
                <li>Prinect PDF Toolbox plugin</li>
                <li>Reference images in <code>Scripts/images/</code> folder</li>
            </ul>

            <h4>Workflow</h4>
            <ol>
                <li>Opens PDF in Acrobat</li>
                <li>Clicks Toolbox button</li>
                <li>Checks if 0.25mm already set (shortcut)</li>
                <li>Configures trapping settings if needed</li>
                <li>Clicks Calculate</li>
                <li>Saves and closes PDF</li>
            </ol>

            <h3>4. bitmap_to_rip_automation.ahk <span class="badge badge-warning">RIP Script</span></h3>
            <p><strong>Location:</strong> <code>Scripts/bitmap_to_rip_automation.ahk</code></p>
            <p>
                <span data-en="Automates Esko Bitmap Viewer to generate RIP PDF from .view files.">Automates Esko Bitmap Viewer to generate RIP PDF from .view files.</span>
                <span data-ru="–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç Esko Bitmap Viewer –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ RIP PDF –∏–∑ —Ñ–∞–π–ª–æ–≤ .view." style="display:none;">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç Esko Bitmap Viewer –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ RIP PDF –∏–∑ —Ñ–∞–π–ª–æ–≤ .view.</span>
            </p>

            <h4>Requirements</h4>
            <ul>
                <li>AutoHotkey v2.0+</li>
                <li>Esko Bitmap Viewer</li>
                <li>Reference images in <code>Scripts/images/</code> folder</li>
            </ul>

            <h4>Workflow</h4>
            <ol>
                <li>Opens .view file in Bitmap Viewer</li>
                <li>Handles color palette dialog</li>
                <li>Configures print settings (19 ppi, 100% scale, Legal size)</li>
                <li>Prints to PDF in RIP folder</li>
            </ol>
        </section>

        <section id="pipeline">
            <h2>
                <span data-en="Processing Pipeline Details">Processing Pipeline Details</span>
                <span data-ru="–î–µ—Ç–∞–ª–∏ –∫–æ–Ω–≤–µ–π–µ—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏" style="display:none;">–î–µ—Ç–∞–ª–∏ –∫–æ–Ω–≤–µ–π–µ—Ä–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏</span>
            </h2>

            <h3>Step 1: Watch Detection (–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ)</h3>
            <p>
                <span data-en="Python script polls 45 watch folders every 2 seconds, detecting new PDF files by filename.">Python script polls 45 watch folders every 2 seconds, detecting new PDF files by filename.</span>
                <span data-ru="Python —Å–∫—Ä–∏–ø—Ç –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç 45 –ø–∞–ø–æ–∫ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã, –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—è –Ω–æ–≤—ã–µ PDF —Ñ–∞–π–ª—ã." style="display:none;">Python —Å–∫—Ä–∏–ø—Ç –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç 45 –ø–∞–ø–æ–∫ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã, –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—è –Ω–æ–≤—ã–µ PDF —Ñ–∞–π–ª—ã.</span>
            </p>

            <h3>Step 2: Trapping (–¢—Ä–µ–ø–ø–∏–Ω–≥)</h3>
            <p>
                <span data-en="Opens PDF in Adobe Acrobat, applies 0.25mm trapping via Prinect PDF Toolbox, saves PDF in place.">Opens PDF in Adobe Acrobat, applies 0.25mm trapping via Prinect PDF Toolbox, saves PDF in place.</span>
                <span data-ru="–û—Ç–∫—Ä—ã–≤–∞–µ—Ç PDF –≤ Adobe Acrobat, –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ç—Ä–µ–ø–ø–∏–Ω–≥ 0.25–º–º —á–µ—Ä–µ–∑ Prinect PDF Toolbox, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª." style="display:none;">–û—Ç–∫—Ä—ã–≤–∞–µ—Ç PDF –≤ Adobe Acrobat, –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ç—Ä–µ–ø–ø–∏–Ω–≥ 0.25–º–º —á–µ—Ä–µ–∑ Prinect PDF Toolbox, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª.</span>
            </p>

            <h3>Step 3: Move to Flexo_Approval</h3>
            <p>
                <span data-en="PDF moved to Esko hotfolder where Esko Automation Engine processes automatically.">PDF moved to Esko hotfolder where Esko Automation Engine processes automatically.</span>
                <span data-ru="PDF –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ –≥–æ—Ä—è—á—É—é –ø–∞–ø–∫—É Esko, –≥–¥–µ Esko Automation Engine –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É." style="display:none;">PDF –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –≤ –≥–æ—Ä—è—á—É—é –ø–∞–ø–∫—É Esko, –≥–¥–µ Esko Automation Engine –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É.</span>
            </p>

            <h3>Step 4: Wait for .view Files</h3>
            <p>
                <span data-en="Monitors output folder, waits 5 seconds after first file for all color separations, returns color count and list of view files.">Monitors output folder, waits 5 seconds after first file for all color separations, returns color count and list of view files.</span>
                <span data-ru="–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –ø–∞–ø–∫—É –≤—ã–≤–æ–¥–∞, –æ–∂–∏–¥–∞–µ—Ç 5 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–¥–µ–ª–µ–Ω–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ–≤ –∏ —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ view." style="display:none;">–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –ø–∞–ø–∫—É –≤—ã–≤–æ–¥–∞, –æ–∂–∏–¥–∞–µ—Ç 5 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–≤–µ—Ç–æ–¥–µ–ª–µ–Ω–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ–≤ –∏ —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ view.</span>
            </p>

            <h3>Step 5: RIP Generation (–ì–µ–Ω–µ—Ä–∞—Ü–∏—è RIP)</h3>
            <p>
                <span data-en="Opens first .view file in Bitmap Viewer, exports as PDF to RIP folder at 19 ppi, Legal paper size.">Opens first .view file in Bitmap Viewer, exports as PDF to RIP folder at 19 ppi, Legal paper size.</span>
                <span data-ru="–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª .view –≤ Bitmap Viewer, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–∞–∫ PDF –≤ –ø–∞–ø–∫—É RIP —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 19 ppi, —Ä–∞–∑–º–µ—Ä –±—É–º–∞–≥–∏ Legal." style="display:none;">–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª .view –≤ Bitmap Viewer, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –∫–∞–∫ PDF –≤ –ø–∞–ø–∫—É RIP —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 19 ppi, —Ä–∞–∑–º–µ—Ä –±—É–º–∞–≥–∏ Legal.</span>
            </p>

            <h3>Step 6: Template Merge (–°–≤–µ–¥–µ–Ω–∏–µ)</h3>
            <div class="info-box">
                <strong>Magenta Rectangle Detection:</strong>
                <ul>
                    <li><strong>LARGE rectangle</strong> = RIP placement position (–ü–æ–∑–∏—Ü–∏—è RIP)</li>
                    <li><strong>SMALL rectangle</strong> = Color count position (–ü–æ–∑–∏—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–∞ —Ü–≤–µ—Ç–æ–≤)</li>
                </ul>
                <p>
                    <span data-en="Centers RIP on large rectangle (rotated 90¬∞), draws color count number on small rectangle, removes magenta from final output.">Centers RIP on large rectangle (rotated 90¬∞), draws color count number on small rectangle, removes magenta from final output.</span>
                    <span data-ru="–¶–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç RIP –Ω–∞ –±–æ–ª—å—à–æ–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–µ (–ø–æ–≤–æ—Ä–æ—Ç 90¬∞), –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ–≤ –Ω–∞ –º–∞–ª–æ–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–µ, —É–¥–∞–ª—è–µ—Ç –º–∞—Ä–∫–µ—Ä—ã magenta –∏–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞." style="display:none;">–¶–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç RIP –Ω–∞ –±–æ–ª—å—à–æ–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–µ (–ø–æ–≤–æ—Ä–æ—Ç 90¬∞), –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–≤–µ—Ç–æ–≤ –Ω–∞ –º–∞–ª–æ–º –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–µ, —É–¥–∞–ª—è–µ—Ç –º–∞—Ä–∫–µ—Ä—ã magenta –∏–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞.</span>
                </p>
            </div>

            <h3>Step 7: Color Table (–¢–∞–±–ª–∏—Ü–∞ —Ü–≤–µ—Ç–æ–≤)</h3>
            <p>
                <span data-en="If enabled, extracts color names from .view filenames and draws table with header row (Armenian text), numbered rows with color swatches, and right-aligned positioning.">If enabled, extracts color names from .view filenames and draws table with header row (Armenian text), numbered rows with color swatches, and right-aligned positioning.</span>
                <span data-ru="–ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ: –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —Ü–≤–µ—Ç–æ–≤ –∏–∑ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ .view –∏ —Ä–∏—Å—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º (–∞—Ä–º—è–Ω—Å–∫–∏–π —Ç–µ–∫—Å—Ç), –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ —Å –æ–±—Ä–∞–∑—Ü–∞–º–∏ —Ü–≤–µ—Ç–∞ –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é." style="display:none;">–ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ: –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è —Ü–≤–µ—Ç–æ–≤ –∏–∑ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ .view –∏ —Ä–∏—Å—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º (–∞—Ä–º—è–Ω—Å–∫–∏–π —Ç–µ–∫—Å—Ç), –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ —Å –æ–±—Ä–∞–∑—Ü–∞–º–∏ —Ü–≤–µ—Ç–∞ –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ–º –ø–æ –ø—Ä–∞–≤–æ–º—É –∫—Ä–∞—é.</span>
            </p>

            <h3>Step 8: PNG Export</h3>
            <p>
                <span data-en="Converts PDF to PNG at configured DPI, deletes original PDF (if configured).">Converts PDF to PNG at configured DPI, deletes original PDF (if configured).</span>
                <span data-ru="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç PDF –≤ PNG —Å –∑–∞–¥–∞–Ω–Ω—ã–º DPI, —É–¥–∞–ª—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π PDF (—Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)." style="display:none;">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç PDF –≤ PNG —Å –∑–∞–¥–∞–Ω–Ω—ã–º DPI, —É–¥–∞–ª—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π PDF (—Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).</span>
            </p>
            <div class="success-box">
                <strong>Output:</strong> <code>ClientApprovals/{filename} APPROVAL.png</code>
            </div>
        </section>

        <section id="templates">
            <h2>
                <span data-en="Template Requirements">Template Requirements</span>
                <span data-ru="–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —à–∞–±–ª–æ–Ω–∞–º" style="display:none;">–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —à–∞–±–ª–æ–Ω–∞–º</span>
            </h2>
            <p>Templates must include:</p>
            <ol>
                <li><strong>Large magenta rectangle</strong> - Position where RIP image will be centered</li>
                <li><strong>Small magenta rectangle</strong> - Position where color count number appears</li>
            </ol>
            <div class="info-box">
                <strong>Magenta Color:</strong> RGB(255, 0, 255) or equivalent
                <p>The automation detects these markers by scanning for magenta pixels and uses their centers for positioning.</p>
            </div>
        </section>

        <section id="pantone">
            <h2>
                <span data-en="Pantone Color System">Pantone Color System</span>
                <span data-ru="–°–∏—Å—Ç–µ–º–∞ —Ü–≤–µ—Ç–æ–≤ Pantone" style="display:none;">–°–∏—Å—Ç–µ–º–∞ —Ü–≤–µ—Ç–æ–≤ Pantone</span>
            </h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Source</strong></td>
                            <td>Colors extracted from panguidc.xml (Corel Pantone library)</td>
                        </tr>
                        <tr>
                            <td><strong>Total Colors</strong></td>
                            <td>970 Pantone colors</td>
                        </tr>
                        <tr>
                            <td><strong>Format</strong></td>
                            <td>RGB values (0-255)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Built-in CMYK Colors</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Code</th>
                            <th>Color</th>
                            <th>RGB</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>C</strong></td>
                            <td>Cyan</td>
                            <td>[0, 174, 239]</td>
                        </tr>
                        <tr>
                            <td><strong>M</strong></td>
                            <td>Magenta</td>
                            <td>[236, 0, 140]</td>
                        </tr>
                        <tr>
                            <td><strong>Y</strong></td>
                            <td>Yellow</td>
                            <td>[255, 242, 0]</td>
                        </tr>
                        <tr>
                            <td><strong>K</strong></td>
                            <td>Black</td>
                            <td>[35, 31, 32]</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>Cup Sizes Supported</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Size</th>
                            <th>Variants</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>100ml</td>
                            <td>Standard</td>
                        </tr>
                        <tr>
                            <td>170ml</td>
                            <td>Standard</td>
                        </tr>
                        <tr>
                            <td>200ml</td>
                            <td>Standard</td>
                        </tr>
                        <tr>
                            <td>230ml</td>
                            <td>IceCream</td>
                        </tr>
                        <tr>
                            <td>250ml</td>
                            <td>Standard, DW (Double Wall)</td>
                        </tr>
                        <tr>
                            <td>300ml</td>
                            <td>Standard, DW, KFC</td>
                        </tr>
                        <tr>
                            <td>320ml</td>
                            <td>Standard</td>
                        </tr>
                        <tr>
                            <td>400ml</td>
                            <td>Standard, DW, Wide</td>
                        </tr>
                        <tr>
                            <td>500ml</td>
                            <td>Standard, Cola</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="info-box">
                <strong>Paper Types:</strong> Craft, Glossy, Laminated<br>
                <strong>Total Configurations:</strong> 45 (15 sizes √ó 3 paper types)
            </div>
        </section>

        <section id="error-handling">
            <h2>
                <span data-en="Error Handling">Error Handling</span>
                <span data-ru="–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫" style="display:none;">–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</span>
            </h2>

            <h3>Multiple PDF Bug Fix</h3>
            <p>
                <span data-en="Previous versions cleared watch folders after each PDF, deleting pending files. Version 2.0+ uses">Previous versions cleared watch folders after each PDF, deleting pending files. Version 2.0+ uses</span>
                <span data-ru="–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ –æ—á–∏—â–∞–ª–∏ –ø–∞–ø–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ PDF, —É–¥–∞–ª—è—è —Ñ–∞–π–ª—ã –≤ –æ—á–µ—Ä–µ–¥–∏. –í–µ—Ä—Å–∏—è 2.0+ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç" style="display:none;">–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ –æ—á–∏—â–∞–ª–∏ –ø–∞–ø–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ PDF, —É–¥–∞–ª—è—è —Ñ–∞–π–ª—ã –≤ –æ—á–µ—Ä–µ–¥–∏. –í–µ—Ä—Å–∏—è 2.0+ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç</span>
                <code>clear_processing_folders()</code>
                <span data-en="which only clears:">which only clears:</span>
                <span data-ru="–∫–æ—Ç–æ—Ä–∞—è –æ—á–∏—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ:" style="display:none;">–∫–æ—Ç–æ—Ä–∞—è –æ—á–∏—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ:</span>
            </p>
            <ul>
                <li>Flexo_Approval/</li>
                <li>Output/</li>
                <li>RIP/</li>
            </ul>
            <div class="success-box">
                <span data-en="Watch folders are preserved between processing.">Watch folders are preserved between processing.</span>
                <span data-ru="–ü–∞–ø–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏." style="display:none;">–ü–∞–ø–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É —Ü–∏–∫–ª–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏.</span>
            </div>

            <h3>Startup Cleanup</h3>
            <p>On startup, <code>clear_working_folders()</code> clears ALL folders including watch folders to ensure clean state.</p>

            <h3>5+ Color Warning</h3>
            <div class="warning-box">
                If more than 5 colors detected, logs warning:<br>
                <code>WARNING: {n} colors detected! Printer supports max 5 inks.</code>
            </div>
        </section>

        <section id="logging">
            <h2>
                <span data-en="Logging">Logging</span>
                <span data-ru="–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ" style="display:none;">–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
            </h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Log File</th>
                            <th>Purpose</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>automation_log.txt</code></td>
                            <td>Main automation log</td>
                        </tr>
                        <tr>
                            <td><code>trapping_log.txt</code></td>
                            <td>Trapping automation log</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h4>Log Format</h4>
            <pre><code>2026-01-17 14:32:15 - INFO - New PDF detected in 300ml_Craft: DESIGN.pdf
2026-01-17 14:32:15 - INFO - [1/7] Step: Trapping PDF...</code></pre>
        </section>

        <section id="troubleshooting">
            <h2>
                <span data-en="Troubleshooting">Troubleshooting</span>
                <span data-ru="–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º" style="display:none;">–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º</span>
            </h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Issue</th>
                            <th>Solution</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>"Template not found"</td>
                            <td>Verify template paths in Path_Config.json</td>
                        </tr>
                        <tr>
                            <td>"Magenta rectangles not found"</td>
                            <td>Add magenta markers to template</td>
                        </tr>
                        <tr>
                            <td>".view file timeout"</td>
                            <td>Check Esko Automation Engine is running</td>
                        </tr>
                        <tr>
                            <td>"RIP PDF timeout"</td>
                            <td>Check Bitmap Viewer is installed</td>
                        </tr>
                        <tr>
                            <td>Wrong Pantone color</td>
                            <td>Update color in pantone_colors section</td>
                        </tr>
                        <tr>
                            <td>AHK script fails</td>
                            <td>Verify reference images in images/ folder</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section id="requirements">
            <h2>
                <span data-en="Requirements">Requirements</span>
                <span data-ru="–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è" style="display:none;">–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</span>
            </h2>

            <h3>Software</h3>
            <ul>
                <li>Python 3.8+</li>
                <li>PyMuPDF (<code>pip install PyMuPDF</code>)</li>
                <li>AutoHotkey v2.0+</li>
                <li>Adobe Acrobat XI Pro</li>
                <li>Prinect PDF Toolbox plugin</li>
                <li>Esko Bitmap Viewer</li>
                <li>Esko Automation Engine (for color separation)</li>
            </ul>

            <h3>Python Dependencies</h3>
            <pre><code>PyMuPDF>=1.18.0</code></pre>
        </section>

        <section id="quickstart">
            <h2>
                <span data-en="Quick Start">Quick Start</span>
                <span data-ru="–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç" style="display:none;">–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</span>
            </h2>
            <ol>
                <li><strong>Configure paths</strong> in <code>Path_Config.json</code></li>
                <li><strong>Place templates</strong> in Templates folders with magenta markers</li>
                <li><strong>Run automation:</strong>
                    <pre><code>cd C:\ExampleJobContainer\Approval_System\Scripts
python approval_automation_v2.py</code></pre>
                </li>
                <li><strong>Drop PDF</strong> in appropriate watch folder</li>
                <li><strong>Output</strong> appears in <code>ClientApprovals/</code> as PNG</li>
            </ol>
        </section>

        <section id="version-history">
            <h2>
                <span data-en="Version History">Version History</span>
                <span data-ru="–ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π" style="display:none;">–ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π</span>
            </h2>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Version</th>
                            <th>Date</th>
                            <th>Changes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1.0</td>
                            <td>Initial</td>
                            <td>Basic single-folder automation</td>
                        </tr>
                        <tr>
                            <td>2.0</td>
                            <td>2026-01-16</td>
                            <td>Multi-folder support, 45 watch configs</td>
                        </tr>
                        <tr>
                            <td>2.0.1</td>
                            <td>2026-01-16</td>
                            <td>Multiple PDF bug fix</td>
                        </tr>
                        <tr>
                            <td>3.0</td>
                            <td>2026-01-17</td>
                            <td>Color table, PNG export, 970 Pantone colors</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <footer style="text-align: center; margin-top: 4rem; padding: 2rem; opacity: 0.6;">
            <p><span data-en="Documentation Version 3.0 | Last Updated: 2026-01-17">Documentation Version 3.0 | Last Updated: 2026-01-17</span><span data-ru="–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ 3.0 | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-01-17" style="display:none;">–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ 3.0 | –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2026-01-17</span></p>
            <p><span data-en="Edgar Alareci - Production Automation System">Edgar Alareci - Production Automation System</span><span data-ru="Edgar Alareci - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞" style="display:none;">Edgar Alareci - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</span></p>
        </footer>
    </div>

    <div class="scroll-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
        ‚Üë
    </div>

    <script>
        // Mobile Navigation Toggle
        function toggleNav() {
            const navMenu = document.getElementById('nav-menu');
            const navIcon = document.getElementById('nav-icon');
            navMenu.classList.toggle('open');
            navIcon.textContent = navMenu.classList.contains('open') ? '‚ñ≤' : '‚ñº';
        }

        // Language Switching
        let currentLang = 'en';

        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const lang = this.dataset.lang;
                if (lang === currentLang) return;

                // Update active button
                document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                // Switch language
                currentLang = lang;
                switchLanguage(lang);
            });
        });

        function switchLanguage(lang) {
            const otherLang = lang === 'en' ? 'ru' : 'en';
            
            // Show elements for selected language, hide others
            document.querySelectorAll(`[data-${lang}]`).forEach(el => {
                el.style.display = '';
            });
            document.querySelectorAll(`[data-${otherLang}]`).forEach(el => {
                el.style.display = 'none';
            });
        }

        // Scroll to top button visibility
        window.addEventListener('scroll', function() {
            const scrollTop = document.querySelector('.scroll-top');
            if (window.pageYOffset > 300) {
                scrollTop.classList.add('visible');
            } else {
                scrollTop.classList.remove('visible');
            }
        });

        // Smooth scroll for navigation links
        document.querySelectorAll('nav a').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
                
                // Close mobile nav after click
                if (window.innerWidth <= 768) {
                    const navMenu = document.getElementById('nav-menu');
                    const navIcon = document.getElementById('nav-icon');
                    navMenu.classList.remove('open');
                    navIcon.textContent = '‚ñº';
                }
            });
        });
    </script>
</body>
</html>
